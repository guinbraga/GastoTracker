<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Gastos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    <h1 th:text="${gasto.id} != null ? 'Editar Gasto' : 'Novo Gasto'"></h1>
    <form th:if="${gasto.id} == null"
          th:action="@{/gastos}" method="post" th:object="${gasto}">

        <label for="valor">Valor</label>
        <input th:field="*{valor}"
               id="valor"
               type="text"
               inputmode="decimal"
               pattern="^\d*([.,]\d{1,2})?$" required/><br>

        <label for="descricao">Descrição</label>
        <input th:field="*{descricao}" id="descricao" type="text"><br>

        <label for="dataGasto">Data</label>
        <input th:field="*{dataGasto}" id="dataGasto" type="datetime-local" required><br>

        <label for="categoria">Categoria</label>
        <select th:field="*{categoria}" id="categoria"><br>
            <option value="Transporte">Transporte</option>
            <option value="Alimentação">Alimentação</option>
            <option value="Saúde">Saúde</option>
            <option value="Educação">Educação</option>
            <option value="Lazer">Lazer</option>
            <option value="Despesas da Casa">Despesas da Casa</option>
        </select><br>

        <label for="formaPagamento">Forma de Pagamento</label>
        <select th:field="*{formaPagamento}" id="formaPagamento"><br>
            <option value="Cartão de Crédito">Cartão de Crédito</option>
            <option value="Pix/Débito">Pix/Débito</option>
        </select>

        <!-- Erros por campo -->
        <div class="error" th:errors="*{valor}"></div>
        <div class="error" th:errors="*{descricao}"></div>
        <div class="error" th:errors="*{dataGasto}"></div>
        <div class="error" th:errors="*{categoria}"></div>
        <div class="error" th:errors="*{formaPagamento}"></div>

        <button type="submit">Salvar Gasto</button>
        <a th:href="@{/gastos}">Cancelar</a>
    </form>

    <form th:if="${gasto.id} != null"
          th:action="@{/gastos/{id}(id=${gasto.id})}" method="post" th:object="${gasto}">
        <input type="hidden" name="_method" value="put"/>

        <label for="valor">Valor</label>
        <input th:field="*{valor}"
               id="valor"
               type="text"
               inputmode="decimal"
               pattern="^\d*([.,]\d{1,2})?$" required/><br>

        <label for="descricao">Descrição</label>
        <input th:field="*{descricao}" id="descricao" type="text"><br>

        <label for="dataGasto">Data</label>
        <input th:field="*{dataGasto}" id="dataGasto" type="datetime-local" required><br>

        <label for="categoria">Categoria</label>
        <select th:field="*{categoria}" id="categoria"><br>
            <option value="Transporte">Transporte</option>
            <option value="Alimentação">Alimentação</option>
            <option value="Saúde">Saúde</option>
            <option value="Educação">Educação</option>
            <option value="Lazer">Lazer</option>
            <option value="Despesas da Casa">Despesas da Casa</option>
        </select><br>

        <label for="formaPagamento">Form a de Pagamento</label>
        <select th:field="*{formaPagamento}" id="formaPagamento"><br>
            <option value="Cartão de Crédito">Cartão de Crédito</option>
            <option value="Pix/Débito">Pix/Débito</option>
        </select>

        <!-- Erros por campo -->
        <div class="error" th:errors="*{valor}"></div>
        <div class="error" th:errors="*{descricao}"></div>
        <div class="error" th:errors="*{dataGasto}"></div>
        <div class="error" th:errors="*{categoria}"></div>
        <div class="error" th:errors="*{formaPagamento}"></div>

        <button type="submit">Atualizar Gasto</button>
        <a th:href="@{/gastos}">Cancelar</a>
    </form>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>